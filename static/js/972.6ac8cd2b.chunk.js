"use strict";(self.webpackChunkmanga_translate=self.webpackChunkmanga_translate||[]).push([[972],{1972:function(e,n,t){t.r(n),t.d(n,{default:function(){return he}});var r=t(586),a=t(6106),i=t(914),s=t(3908),c=t(6428),o=t(2791),u=t(9434),l=function(e){return"data:image/jpeg;base64,".concat(e)},d=t(9439),h=t(5057),x=t(3371),p=t(3707),g=t(5434),m=t(4587),f=t(763),v=t(2656);var Z,j=t(1413),k=t(6382),b={fontSize:14,maxWidth:15,showOriginText:!1,handing:!1},y=(Z={name:"translateStore",initialState:b,reducers:{changeFontSize:function(e,n){e.fontSize=n.payload},changeShowOriginText:function(e,n){e.showOriginText=n.payload},changeMaxWidth:function(e,n){e.maxWidth=n.payload},detectBubble:function(e){e.handing=!0},translateText:function(e,n){e.handing=!0},removeText:function(e,n){e.handing=!0},updateDataDetect:function(e,n){e.dataDetect=n.payload,e.handing=!1},updateOriginImage:function(e,n){e.originImage=n.payload},updateImageDetect:function(e,n){e.dataDetect=(0,j.Z)((0,j.Z)({},e.dataDetect),{},{imageDetected:n.payload}),e.handing=!1}}},(0,k.oM)(Z)),T=y.actions,w=y.name,R=y.reducer,O=t(4165),I=t(429),D=t(7780),C="".concat("http://localhost",":").concat(8e3),E=t(5861),S=t(3144),_=t(5671),z=t(6924);function F(e){var n={kind:"unknown"};switch(e.problem){case"CONNECTION_ERROR":case"NETWORK_ERROR":n={kind:"cannot-connect",temporary:!0};break;case"TIMEOUT_ERROR":n={kind:"timeout",temporary:!0};break;case"SERVER_ERROR":n={kind:"server",error:e.originalError};break;case"CLIENT_ERROR":switch(e.status){case 401:n={kind:"unauthorized"};break;case 403:n={kind:"forbidden"};break;case 404:n={kind:"not-found"};break;default:n={kind:"rejected"}}break;case"CANCEL_ERROR":n={kind:"cancelled"}}return e.originalError&&(n.error=e.originalError),n}var N=(0,S.Z)((function e(n){var t=this;(0,_.Z)(this,e),this.api=void 0,this.config=void 0,this.post=function(){var e=(0,E.Z)((0,O.Z)().mark((function e(n,r){var a;return(0,O.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.post(n,r);case 2:if(!(a=e.sent).ok){e.next=5;break}return e.abrupt("return",{kind:"ok",data:a.data});case 5:return e.abrupt("return",F(a));case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),this.config=n,this.api=(0,z.Ue)(n)})),W=new N({baseURL:C}),P=t(6916),B=function(e){return(null===e||void 0===e?void 0:e.translateStore)||b},H=(0,P.P1)([B],(function(e){return e.handing})),V=((0,P.P1)([B],(function(e){return e.fontSize})),(0,P.P1)([B],(function(e){return e.showOriginText}))),L=(0,P.P1)([B],(function(e){return e.originImage})),M=(0,P.P1)([B],(function(e){return e})),U=(0,P.P1)([B],(function(e){return e.dataDetect})),Y=(0,O.Z)().mark(q),$=(0,O.Z)().mark(G),A=(0,O.Z)().mark(J),K=(0,O.Z)().mark(Q);function q(){var e,n;return(0,O.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,D.Ys)(L);case 2:return e=t.sent,t.next=5,W.post("/detectBubble",{image:e});case 5:if("ok"!==(n=t.sent).kind){t.next=10;break}return t.next=9,(0,D.gz)(T.updateDataDetect(n.data));case 9:return t.abrupt("return");case 10:return t.next=12,(0,D.gz)(T.updateDataDetect(void 0));case 12:I.Z.warning({message:"Detect Fail",description:n.kind});case 13:case"end":return t.stop()}}),Y)}function G(e){var n,t,r;return(0,O.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.payload,a.next=3,(0,D.Ys)(M);case 3:return t=a.sent,a.next=6,W.post("/translateText",{image:t.originImage,fontSize:t.fontSize,maxWidth:t.maxWidth,dataTrans:n});case 6:if("ok"!==(r=a.sent).kind){a.next=11;break}return a.next=10,(0,D.gz)(T.updateImageDetect(r.data.image));case 10:return a.abrupt("return");case 11:I.Z.warning({message:"Translate Fail",description:r.kind});case 12:case"end":return a.stop()}}),$)}function J(e){var n,t,r;return(0,O.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.payload,a.next=3,(0,D.Ys)(L);case 3:return t=a.sent,a.next=6,W.post("/removeText",{image:t,location:n});case 6:if("ok"!==(r=a.sent).kind){a.next=11;break}return a.next=10,(0,D.gz)(T.updateImageDetect(r.data.image));case 10:return a.abrupt("return");case 11:I.Z.warning({message:"Remmove Text Fail",description:r.kind});case 12:case"end":return a.stop()}}),A)}function Q(){return(0,O.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,D.$6)([(0,D.Fm)(T.detectBubble.type,q)]);case 2:return e.next=4,(0,D.$6)([(0,D.Fm)(T.translateText.type,G)]);case 4:return e.next=6,(0,D.$6)([(0,D.Fm)(T.removeText.type,J)]);case 6:case"end":return e.stop()}}),K)}var X=function(){var e;return e={key:w,reducer:R},(0,v.vp)(e),function(e){(0,v.hb)(e)}({key:w,saga:Q}),{actions:T}},ee="styles_header__uOkvL",ne=t(184),te=function(){var e=(0,u.v9)(M),n=(0,u.I0)(),t=X().actions,s=h.Z.useForm(),c=(0,d.Z)(s,1)[0];(0,o.useEffect)((function(){c.setFieldsValue({fontSize:e.fontSize,showOriginText:e.showOriginText,maxWidth:e.maxWidth})}),[c,e]);var l=function(){n(t.updateOriginImage(void 0)),n(t.updateDataDetect(void 0))};return(0,ne.jsxs)(r.Z.Header,{className:ee,style:{display:"inline-table"},children:[(0,ne.jsx)(x.Z.Title,{level:5,children:"Translate Manga"}),(0,ne.jsx)(a.Z,{gutter:[12,12],children:e.dataDetect?(0,ne.jsx)(h.Z,{form:c,layout:"vertical",style:{width:"100%"},onValuesChange:function(e){var r=e.fontSize,a=e.maxWidth,i=e.showOriginText;n(r?t.changeFontSize(r):a?t.changeMaxWidth(a):t.changeShowOriginText(i))},children:(0,ne.jsxs)(a.Z,{gutter:[12,12],style:{alignItems:"center"},children:[(0,ne.jsx)(i.Z,{span:3,children:(0,ne.jsx)(h.Z.Item,{label:"S\u1ed1 ch\u1eef tr\xean 1 d\xf2ng",name:"maxWidth",children:(0,ne.jsx)(g.Z,{options:(0,f.range)(10,30,1).map((function(e){return{value:e,label:e}}))})})}),(0,ne.jsx)(i.Z,{span:3,children:(0,ne.jsx)(h.Z.Item,{label:"C\u1ee1 ch\u1eef",name:"fontSize",children:(0,ne.jsx)(g.Z,{options:(0,f.range)(10,50,1).map((function(e){return{value:e,label:e}}))})})}),(0,ne.jsx)(i.Z,{span:6,style:{alignItems:"center",margin:0},children:(0,ne.jsx)(h.Z.Item,{name:"showOriginText",valuePropName:"checked",style:{marginBottom:0},children:(0,ne.jsx)(m.Z,{children:"Hi\u1ec3n th\u1ecb v\u0103n b\u1ea3n g\u1ed1c"})})}),(0,ne.jsx)(i.Z,{children:(0,ne.jsx)(p.Z,{danger:!0,type:"primary",onClick:l,children:"Remove/Change Image"})})]})}):(0,ne.jsxs)(ne.Fragment,{children:[(0,ne.jsx)(i.Z,{children:(0,ne.jsx)(p.Z,{type:"primary",onClick:function(){return n(t.detectBubble())},children:"Detect Bubble"})}),(0,ne.jsx)(i.Z,{children:(0,ne.jsx)(p.Z,{type:"primary",danger:!0,onClick:l,children:"Remove/Change Image"})})]})})]})},re=t(769),ae=t(4048),ie=function(){var e=ae.Z.Dragger,n=(0,u.I0)(),t=X().actions;return(0,ne.jsxs)(e,{height:window.innerHeight-200,name:"file",beforeUpload:function(e){(function(e){return new Promise((function(n,t){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return n(r.result.toString().split(",")[1])},r.onerror=function(e){return t(e)}}))})(e).then((function(e){return n(t.updateOriginImage(e))}))},children:[(0,ne.jsx)("p",{className:"ant-upload-drag-icon",children:(0,ne.jsx)(re.Z,{})}),(0,ne.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),(0,ne.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibited from uploading company data or other banned files."})]})},se="styles_container__yaDan",ce="styles_content__Bx-04",oe=t(4322),ue=t(5581),le=function(){var e,n=h.Z.useForm(),t=(0,d.Z)(n,1)[0],s=(0,u.I0)(),c=X().actions,l=(0,u.v9)(U),x=(0,u.v9)(V);(0,o.useEffect)((function(){var e,n={};Object.entries(null!==(e=null===l||void 0===l?void 0:l.groupText)&&void 0!==e?e:{}).forEach((function(e){var t=(0,d.Z)(e,2),r=t[0],a=t[1];n[r]={isTrans:!0,text:a.text,textTrans:a.textTrans}})),t.setFieldsValue(n)}),[t]);return(0,ne.jsxs)(r.Z,{style:{background:"white"},children:[(0,ne.jsx)(h.Z,{form:t,layout:"vertical",children:Object.entries(null!==(e=null===l||void 0===l?void 0:l.groupText)&&void 0!==e?e:{}).sort((function(e,n){var t=(0,d.Z)(e,1)[0],r=(0,d.Z)(n,1)[0];return t.localeCompare(r)})).map((function(e){var n=(0,d.Z)(e,1)[0];return(0,ne.jsxs)(a.Z,{gutter:10,align:"middle",children:[x?(0,ne.jsx)(i.Z,{span:11,children:(0,ne.jsx)(h.Z.Item,{label:n,name:[n,"text"],children:(0,ne.jsx)(oe.Z,{})})}):null,(0,ne.jsx)(i.Z,{span:x?11:22,children:(0,ne.jsx)(h.Z.Item,{label:x?"B\u1ea3n d\u1ecbch":n,name:[n,"textTrans"],children:(0,ne.jsx)(oe.Z,{})})}),(0,ne.jsx)(i.Z,{span:2,children:(0,ne.jsx)(h.Z.Item,{label:"Ch\u1ecdn",name:[n,"isTrans"],valuePropName:"checked",children:(0,ne.jsx)(ue.Z,{})})})]},n)}))}),(0,ne.jsxs)(a.Z,{gutter:[10,10],style:{justifyContent:"center"},children:[(0,ne.jsx)(i.Z,{children:(0,ne.jsx)(p.Z,{type:"primary",onClick:function(){var e=t.getFieldsValue(),n=[];Object.entries(null!==e&&void 0!==e?e:{}).forEach((function(t){var r,a=(0,d.Z)(t,2),i=a[0];a[1].isTrans&&n.push({text:e[i].textTrans,location:null===l||void 0===l||null===(r=l.groupText)||void 0===r?void 0:r[i].locate})})),s(c.translateText(n))},children:"Translate Comic"})}),(0,ne.jsx)(i.Z,{children:(0,ne.jsx)(p.Z,{danger:!0,type:"primary",onClick:function(){var e=t.getFieldsValue(),n={};Object.entries(e).forEach((function(e){var t,r=(0,d.Z)(e,2),a=r[0];r[1].isTrans&&(n[a]=null===l||void 0===l||null===(t=l.groupText)||void 0===t?void 0:t[a].locate)})),s(c.removeText(n))},children:"Remove Text In Comic"})})]})]})},de=function(){var e=(0,u.v9)(L),n=(0,u.v9)(H),t=(0,u.v9)(U);return(0,ne.jsxs)(r.Z,{className:se,children:[n?(0,ne.jsx)(c.Z,{}):null,(0,ne.jsx)(te,{}),(0,ne.jsx)(r.Z.Content,{className:ce,children:(0,ne.jsxs)(a.Z,{gutter:[16,8],style:{minHeight:window.innerHeight-200},children:[(0,ne.jsx)(i.Z,{span:e?10:24,children:e?(0,ne.jsx)(s.Z,{style:{maxHeight:window.innerHeight-200},src:null!==t&&void 0!==t&&t.imageDetected?l(t.imageDetected):l(e)}):(0,ne.jsx)(ie,{})}),(0,ne.jsx)(i.Z,{span:14,children:t?(0,ne.jsx)(le,{}):null})]})})]})},he=function(){return(0,ne.jsx)(r.Z,{children:(0,ne.jsx)(de,{})})}}}]);
//# sourceMappingURL=972.6ac8cd2b.chunk.js.map