"use strict";(self.webpackChunkmanga_translate=self.webpackChunkmanga_translate||[]).push([[198],{2198:function(e,n,t){t.r(n),t.d(n,{default:function(){return ge}});var a=t(586),r=t(6106),i=t(914),s=t(3908),o=t(6428),c=t(2791),u=t(9434),l=function(e){return"data:image/jpeg;base64,".concat(e)},d=t(9439),h=t(5057),x=t(3371),g=t(3707),m=t(5434),p=t(4587),f=["Mynerve","Bangers","Fruktur","Gluten","Roboto","SedgwickAveDisplay"],v=t(763),Z=t.n(v),j=t(2656);var b,k=t(1413),y=t(6382),T={fontSize:14,maxWidth:15,showOriginText:!1,handing:!1,useCurrentImage:!0,font:"Gluten"},I=(b={name:"translateStore",initialState:T,reducers:{changeFont:function(e,n){e.font=n.payload},changeFontSize:function(e,n){e.fontSize=n.payload},changeShowOriginText:function(e,n){e.showOriginText=n.payload},changeMaxWidth:function(e,n){e.maxWidth=n.payload},changeUseCurrentImage:function(e,n){e.useCurrentImage=n.payload},detectBubble:function(e){e.handing=!0},translateText:function(e,n){e.handing=!0},removeText:function(e,n){e.handing=!0},updateDataDetect:function(e,n){e.dataDetect=n.payload,e.handing=!1},updateOriginImage:function(e,n){e.originImage=n.payload},updateImageDetect:function(e,n){e.handing=!1,n.payload&&(e.dataDetect=(0,k.Z)((0,k.Z)({},e.dataDetect),{},{imageDetected:n.payload}))},updateTranslated:function(e,n){e.translated=(0,k.Z)((0,k.Z)({},e.translated),n.payload)}}},(0,y.oM)(b)),w=I.actions,C=I.name,O=I.reducer,R=t(4165),D=t(429),S=t(7780),E="".concat("http://localhost",":").concat(8e3),z=t(5861),F=t(3144),N=t(5671),_=t(6924);function W(e){var n={kind:"unknown"};switch(e.problem){case"CONNECTION_ERROR":case"NETWORK_ERROR":n={kind:"cannot-connect",temporary:!0};break;case"TIMEOUT_ERROR":n={kind:"timeout",temporary:!0};break;case"SERVER_ERROR":n={kind:"server",error:e.originalError};break;case"CLIENT_ERROR":switch(e.status){case 401:n={kind:"unauthorized"};break;case 403:n={kind:"forbidden"};break;case 404:n={kind:"not-found"};break;default:n={kind:"rejected"}}break;case"CANCEL_ERROR":n={kind:"cancelled"}}return e.originalError&&(n.error=e.originalError),n}var B=(0,F.Z)((function e(n){var t=this;(0,N.Z)(this,e),this.api=void 0,this.config=void 0,this.post=function(){var e=(0,z.Z)((0,R.Z)().mark((function e(n,a){var r;return(0,R.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.api.post(n,a);case 2:if(!(r=e.sent).ok){e.next=5;break}return e.abrupt("return",{kind:"ok",data:r.data});case 5:return e.abrupt("return",W(r));case 6:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),this.config=n,this.api=(0,_.Ue)(n)})),P=new B({baseURL:E}),H=t(6916),U=function(e){return(null===e||void 0===e?void 0:e.translateStore)||T},L=(0,H.P1)([U],(function(e){return e.handing})),M=((0,H.P1)([U],(function(e){return e.fontSize})),(0,H.P1)([U],(function(e){return e.showOriginText}))),V=(0,H.P1)([U],(function(e){return e.originImage})),A=(0,H.P1)([U],(function(e){return e})),G=(0,H.P1)([U],(function(e){return e.dataDetect})),Y=(0,R.Z)().mark(J),$=(0,R.Z)().mark(Q),K=(0,R.Z)().mark(X),q=(0,R.Z)().mark(ee);function J(){var e,n;return(0,R.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,S.Ys)(V);case 2:return e=t.sent,t.next=5,P.post("/detectBubble",{image:e});case 5:if("ok"!==(n=t.sent).kind){t.next=10;break}return t.next=9,(0,S.gz)(w.updateDataDetect(n.data));case 9:return t.abrupt("return");case 10:return t.next=12,(0,S.gz)(w.updateDataDetect(void 0));case 12:D.Z.warning({message:"Detect Fail",description:n.kind});case 13:case"end":return t.stop()}}),Y)}function Q(e){var n,t,a,r,i,s,o;return(0,R.Z)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return a=e.payload,c.next=3,(0,S.Ys)(A);case 3:return r=c.sent,i=!r.useCurrentImage,c.next=7,P.post("/translateText",{image:i?r.originImage:null===(n=r.dataDetect)||void 0===n?void 0:n.imageDetected,fontSize:r.fontSize,maxWidth:r.maxWidth,dataTrans:Object.values(a).map((function(e){return e})),font:null!==(t=r.font)&&void 0!==t?t:"Roboto"});case 7:if("ok"!==(s=c.sent).kind){c.next=16;break}return o={},Object.entries(a).forEach((function(e){var n=(0,d.Z)(e,2),t=n[0],a=n[1];o[t]={text:a.text,location:a.location,font:r.font,fontSize:r.fontSize,textInLine:r.maxWidth}})),c.next=13,(0,S.gz)(w.updateImageDetect(s.data.image));case 13:return c.next=15,(0,S.gz)(w.updateTranslated(o));case 15:return c.abrupt("return");case 16:return c.next=18,(0,S.gz)(w.updateImageDetect());case 18:D.Z.warning({message:"Translate Fail",description:s.kind});case 19:case"end":return c.stop()}}),$)}function X(e){var n,t,a,r,i,s;return(0,R.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,o.next=3,(0,S.Ys)(A);case 3:return a=o.sent,r=Object.keys(t).map((function(e){return e})),i={},Object.entries(null!==(n=a.translated)&&void 0!==n?n:{}).forEach((function(e){var n=(0,d.Z)(e,2),t=n[0],a=n[1];r.includes(t)||(i[t]=a)})),o.next=9,P.post("/removeText",{image:a.originImage,location:t,translated:i});case 9:if("ok"!==(s=o.sent).kind){o.next=14;break}return o.next=13,(0,S.gz)(w.updateImageDetect(s.data.image));case 13:return o.abrupt("return");case 14:return o.next=16,(0,S.gz)(w.updateImageDetect());case 16:D.Z.warning({message:"Remmove Text Fail",description:s.kind});case 17:case"end":return o.stop()}}),K)}function ee(){return(0,R.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,S.$6)([(0,S.Fm)(w.detectBubble.type,J)]);case 2:return e.next=4,(0,S.$6)([(0,S.Fm)(w.translateText.type,Q)]);case 4:return e.next=6,(0,S.$6)([(0,S.Fm)(w.removeText.type,X)]);case 6:case"end":return e.stop()}}),q)}var ne=function(){var e;return e={key:C,reducer:O},(0,j.vp)(e),function(e){(0,j.hb)(e)}({key:C,saga:ee}),{actions:w}},te="styles_header__uOkvL",ae=t(184),re=function(){var e=(0,u.v9)(A),n=(0,u.I0)(),t=ne().actions,s=h.Z.useForm(),o=(0,d.Z)(s,1)[0];(0,c.useEffect)((function(){var n;o.setFieldsValue({fontSize:e.fontSize,showOriginText:e.showOriginText,maxWidth:e.maxWidth,useCurrentImage:e.useCurrentImage,font:null!==(n=e.font)&&void 0!==n?n:"Gluten"})}),[o,e]);var l=function(){n(t.updateOriginImage(void 0)),n(t.updateDataDetect(void 0))};return(0,ae.jsxs)(a.Z.Header,{className:te,style:{display:"inline-table"},children:[(0,ae.jsx)(x.Z.Title,{level:5,children:"Translate Manga"}),(0,ae.jsx)(r.Z,{gutter:[12,12],children:e.dataDetect?(0,ae.jsx)(h.Z,{form:o,layout:"vertical",style:{width:"100%"},onValuesChange:function(e){var a=e.fontSize,r=e.maxWidth,i=e.showOriginText,s=e.useCurrentImage,o=e.font;a?n(t.changeFontSize(a)):r?n(t.changeMaxWidth(r)):Z().isNil(i)?Z().isNil(s)?o&&n(t.changeFont(o)):n(t.changeUseCurrentImage(s)):n(t.changeShowOriginText(i))},children:(0,ae.jsxs)(r.Z,{gutter:[12,12],style:{alignItems:"center"},children:[(0,ae.jsx)(i.Z,{span:3,children:(0,ae.jsx)(h.Z.Item,{label:"Font",name:"font",children:(0,ae.jsx)(m.Z,{options:f.map((function(e){return{value:e,label:(0,ae.jsx)(x.Z,{style:{fontFamily:e},children:e})}}))})})}),(0,ae.jsx)(i.Z,{span:3,children:(0,ae.jsx)(h.Z.Item,{label:"C\u1ee1 ch\u1eef",name:"fontSize",children:(0,ae.jsx)(m.Z,{options:(0,v.range)(10,50,1).map((function(e){return{value:e,label:e}}))})})}),(0,ae.jsx)(i.Z,{span:3,children:(0,ae.jsx)(h.Z.Item,{label:"S\u1ed1 ch\u1eef tr\xean 1 d\xf2ng",name:"maxWidth",children:(0,ae.jsx)(m.Z,{options:(0,v.range)(1,30,1).map((function(e){return{value:e,label:e}}))})})}),(0,ae.jsxs)(i.Z,{span:6,style:{alignItems:"center",margin:0},children:[(0,ae.jsx)(h.Z.Item,{name:"showOriginText",valuePropName:"checked",style:{marginBottom:0},children:(0,ae.jsx)(p.Z,{children:"Hi\u1ec3n th\u1ecb v\u0103n b\u1ea3n g\u1ed1c"})}),(0,ae.jsx)(h.Z.Item,{name:"useCurrentImage",valuePropName:"checked",style:{marginBottom:0},children:(0,ae.jsx)(p.Z,{children:"S\u1eed d\u1ee5ng h\xecnh hi\u1ec7n t\u1ea1i \u0111\u1ec3 d\u1ecbch"})})]}),(0,ae.jsx)(i.Z,{children:(0,ae.jsx)(g.Z,{danger:!0,type:"primary",onClick:l,children:"Remove/Change Image"})})]})}):(0,ae.jsxs)(ae.Fragment,{children:[(0,ae.jsx)(i.Z,{children:(0,ae.jsx)(g.Z,{type:"primary",onClick:function(){return n(t.detectBubble())},children:"Detect Bubble"})}),(0,ae.jsx)(i.Z,{children:(0,ae.jsx)(g.Z,{type:"primary",danger:!0,onClick:l,children:"Remove/Change Image"})})]})})]})},ie=t(769),se=t(4048),oe=function(){var e=se.Z.Dragger,n=(0,u.I0)(),t=ne().actions;return(0,ae.jsxs)(e,{height:window.innerHeight-200,name:"file",beforeUpload:function(e){(function(e){return new Promise((function(n,t){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return n(a.result.toString().split(",")[1])},a.onerror=function(e){return t(e)}}))})(e).then((function(e){return n(t.updateOriginImage(e))}))},children:[(0,ae.jsx)("p",{className:"ant-upload-drag-icon",children:(0,ae.jsx)(ie.Z,{})}),(0,ae.jsx)("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"}),(0,ae.jsx)("p",{className:"ant-upload-hint",children:"Support for a single or bulk upload. Strictly prohibited from uploading company data or other banned files."})]})},ce="styles_container__yaDan",ue="styles_content__Bx-04",le=t(4322),de=t(5581),he=function(){var e,n=h.Z.useForm(),t=(0,d.Z)(n,1)[0],s=(0,u.I0)(),o=ne().actions,l=(0,u.v9)(G),x=(0,u.v9)(M);(0,c.useEffect)((function(){var e,n={};Object.entries(null!==(e=null===l||void 0===l?void 0:l.groupText)&&void 0!==e?e:{}).forEach((function(e){var t=(0,d.Z)(e,2),a=t[0],r=t[1];n[a]={isTrans:!0,text:r.text,textTrans:r.textTrans}})),t.setFieldsValue(n)}),[t]);return(0,ae.jsxs)(a.Z,{style:{background:"white"},children:[(0,ae.jsx)(h.Z,{form:t,layout:"vertical",children:Object.entries(null!==(e=null===l||void 0===l?void 0:l.groupText)&&void 0!==e?e:{}).sort((function(e,n){var t=(0,d.Z)(e,1)[0],a=(0,d.Z)(n,1)[0];return Number(t.split("p")[1])-Number(a.split("p")[1])})).map((function(e){var n=(0,d.Z)(e,1)[0];return(0,ae.jsxs)(r.Z,{gutter:10,align:"middle",children:[x?(0,ae.jsx)(i.Z,{span:11,children:(0,ae.jsx)(h.Z.Item,{label:n.split("p")[1],name:[n,"text"],children:(0,ae.jsx)(le.Z,{})})}):null,(0,ae.jsx)(i.Z,{span:x?11:22,children:(0,ae.jsx)(h.Z.Item,{label:x?"B\u1ea3n d\u1ecbch":n,name:[n,"textTrans"],children:(0,ae.jsx)(le.Z,{})})}),(0,ae.jsx)(i.Z,{span:2,children:(0,ae.jsx)(h.Z.Item,{label:"Ch\u1ecdn",name:[n,"isTrans"],valuePropName:"checked",children:(0,ae.jsx)(de.Z,{})})})]},n)}))}),(0,ae.jsxs)(r.Z,{gutter:[10,10],style:{justifyContent:"center"},children:[(0,ae.jsx)(i.Z,{children:(0,ae.jsx)(g.Z,{type:"primary",onClick:function(){var e=t.getFieldsValue(),n={};Object.entries(null!==e&&void 0!==e?e:{}).forEach((function(t){var a,r=(0,d.Z)(t,2),i=r[0];r[1].isTrans&&(n[i]={text:e[i].textTrans,location:null===l||void 0===l||null===(a=l.groupText)||void 0===a?void 0:a[i].locate})})),s(o.translateText(n))},children:"Translate Comic"})}),(0,ae.jsx)(i.Z,{children:(0,ae.jsx)(g.Z,{danger:!0,type:"primary",onClick:function(){var e=t.getFieldsValue(),n={};Object.entries(e).forEach((function(e){var t,a=(0,d.Z)(e,2),r=a[0];a[1].isTrans&&(n[r]=null===l||void 0===l||null===(t=l.groupText)||void 0===t?void 0:t[r].locate)})),s(o.removeText(n))},children:"Remove Text In Comic"})})]})]})},xe=function(){var e=(0,u.v9)(V),n=(0,u.v9)(L),t=(0,u.v9)(G);return(0,ae.jsxs)(a.Z,{className:ce,children:[n?(0,ae.jsx)(o.Z,{}):null,(0,ae.jsx)(re,{}),(0,ae.jsx)(a.Z.Content,{className:ue,children:(0,ae.jsxs)(r.Z,{gutter:[16,8],style:{minHeight:window.innerHeight-200},children:[(0,ae.jsx)(i.Z,{span:e?10:24,children:e?(0,ae.jsx)(s.Z,{style:{maxHeight:window.innerHeight-200},src:null!==t&&void 0!==t&&t.imageDetected?l(t.imageDetected):l(e)}):(0,ae.jsx)(oe,{})}),(0,ae.jsx)(i.Z,{span:14,children:t?(0,ae.jsx)(he,{}):null})]})})]})},ge=function(){return(0,ae.jsx)(a.Z,{children:(0,ae.jsx)(xe,{})})}}}]);
//# sourceMappingURL=198.4f1e1585.chunk.js.map